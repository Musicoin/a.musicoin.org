
<div class="chat-messages">
    <%
        var _showTrack = typeof showTrack != "undefined" ? showTrack : false;
        var _noContentMessage = typeof noContentMessage != "undefined" ? noContentMessage : "Be the first to comment";
    %>
    <% if (messages.length == 0) { %>
    <div class="center-text subtle-text pad20">
        <%=_noContentMessage%>
    </div>
    <% } %>
    <% for (var i=0; i < messages.length; i++) {
        var message = messages[i];
        var icon = message.tips > 0
                ? '<i class="fa fa-star message-tip" aria-hidden="true"></i>'
                : '<i class="fa fa-star-o  message-tip" aria-hidden="true"></i>'
        var textClass = message.tips > 0 ? "text-warning" : "subtle-text";
        var track = message.release;
        var showThisTrack = _showTrack && message.release;
        var releaseid = track ? track.id : "";
        var licenseAddress = track ? track.contractAddress : "";
        var highlight = track
            ? message.sender.profileAddress == track.artistAddress
            : false;
        var messageClass = highlight ? "chat-message-highlight" : "chat-message";
    %>
    <div class="<%=messageClass%>"
         releaseid="<%=releaseid%>"
         licenseAddress='<%=licenseAddress%>'
         senderAddress="<%=message.sender.profileAddress%>"
         messageid="<%=message.id%>">
        <%=message.followReason%>
        <div class="center-text">
            <% if (showThisTrack) { %>
            <div class="audio-track clickable m10 text-xlarge" licenseAddress='<%=track.contractAddress%>'>
                <i class="fa fa-play-circle" aria-hidden="true"></i>
            </div>
            <% } %>

            <a href="/artist/<%=message.sender.profileAddress%>"><div style="background-image: url('<%=message.sender.image%>')" class="sender-image"></div></a>
            <% if (showThisTrack) { %>
            <!--<i class="fa fa-long-arrow-right subtle-text big-screen-only" aria-hidden="true"></i>&nbsp;-->
            <!--<a href="/track/<%=track.contractAddress%>" class="big-screen-only"><div style="background-image: url('<%=track.image%>')" class="sender-image"></div></a>-->
            <% } %>
        </div>
        <div class="chat-message-area">
            <div class="chat-message-sender">
                <a href="/artist/<%=message.sender.profileAddress%>"><%=message.sender.name%></a>
                <% if (showThisTrack) { %>
                on
                <a href="/track/<%=track.contractAddress%>"><%=track.title%></a>
                <% } %>
                <span class="message-time big-screen-only"><%=message.time%></span>
            </div>
            <div class="chat-message-body"><%=message.body%></div>
            <div class="inline-reply" style="display: none"><input placeholder="reply" class="inline-reply-input fill-width"></div>
        </div>
        <div class="action-area">
            <div class="subtle-text big-screen-only"><%= message.tips > 0 ? `(${message.tips})` : ""%>&nbsp;</div>
            <i class="fa fa-reply btn subtle-text inline-reply-action" aria-hidden="true"></i>

            <div id="player-tip-button"
                 class="tip-button tip-button btn-xs clickable <%=textClass%>"
                 recipient="<%=message.sender.profileAddress%>"
                 amount="1"
                 on-success="refreshMessageList()"
                 text-success=':)'
                 text-fail=":("
                 text-default='icon'
                 context-type="TrackMessage"
                 title="Send 1 musicoin to <%=message.sender.name%> for this comment"
                 context-id="<%=message.id%>">
                <%-icon%>
            </div>
        </div>
    </div>
    <%}%>
</div>
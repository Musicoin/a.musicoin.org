<audio autoplay id="player"></audio>
<style>
    .player {
        background-color: #333;
        height: 64px;
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        overflow: hidden;
    }

    .player-foreground {
        display: flex;
        align-items: center;
        justify-content: space-around;
        flex-direction: row;
        position: absolute;
        background: black;
        top: 0;
        left: 0;
        bottom: 5px;
        right: 0;
        z-index: 2;
        min-width: 300px;
        width: 100%;
        height: 100%;
        padding-left: 10px;
        padding-right: 10px;
    }

    .player-bookend {
        height: 100%;
        width: 250px;
    }

    .song-badge {
        display: flex;
        align-items: center;
        max-width: 400px;
        min-width: 33%;
    }

    .player-segment {
        overflow: hidden;
        white-space: nowrap;
        flex-basis: 40%;
        margin-right: 10px;
    }

    .player-action-area {
        display: flex;
        flex-direction: row;
        color: white;
        font-size: 14pt;
        height: 100%;
        justify-content: flex-end;
        align-items: center;
        flex-basis: 20%;
        max-width: 150px;
    }

    .song-badge-info {
        display: flex;
        flex-direction: column;
        margin: 10px;
        overflow: hidden;
    }

    .song-badge-image {
        max-width: 48px;
        height: 48px;
        object-fit: contain;
    }

    .player-song-name {
        color: white;
        font-size: 14pt;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .player-artist-name {
        color: rgba(255,255,255,0.5);
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
    }

    .player-controls {
        display: flex;
        justify-content: center;
        align-items: baseline;
    }

    .player-progress {
        position: relative;
        height: 10px;
        flex-grow: 1;
    }

    .progress-bar {
        position: absolute;
        left: 0;
        height: 4px;
        border-radius: 5px !important;
    }

    .progress-background {
        right: 0;
        width: 100%;
        background-color: #0097D0;
    }

    .progress-foreground {
        width: 0%;
        background-color: white;
    }

    .player-controls-area {
        height: 100%;
        flex-grow: 1;
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-content: center;
        align-items: center;
    }

    .player-background {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background-size: cover;
        background-position: center;
        filter: blur(5px);
        overflow: hidden;
        opacity: 0.3;
        z-index: 1;
    }


    .play-controls-container {
        display: flex;
        justify-content: space-between;
    }

    .player-control {
        color: white;
        font-size: 36px;
        cursor: pointer;
    }

    .player-control.disabled {
        color: rgba(255,255,255,0.2);
    }

    .player-control-large {
    }

    .player-action-values {
        margin-right: 5px;
        text-align: right;
    }

    .player-time-area {
        display: flex;
        justify-content: space-between;
        color: white;
    }

    .player-progress-row {
        display: flex;
        flex-direction: column;
    }

    .selected-track {
        background-color: rgba(255, 255, 255, 0.1);
    }

    #player-message {
        display: none;
    }

    .player-time-field {
        min-width: 50px;
        text-align: center;
    }

    #player-tip-button {
        margin-right: 10px;
        font-size: 14pt;
    }

    .no_selection {
        -webkit-user-select: none; /* webkit (safari, chrome) browsers */
        -moz-user-select: none; /* mozilla browsers */
        -khtml-user-select: none; /* webkit (konqueror) browsers */
        -ms-user-select: none; /* IE10+ */
    }

    .progress-thumb {
        position: absolute;
        border-radius: 50%;
        background-color: #FFCD00;
        width: 16px;
        height: 16px;
        top: -6px;
        left: -8px;
        transition: none;
    }

    .button-highlight {
        color: #e4aa17;
        text-shadow: 0 0 3px #fcc017;
    }

    .queue-size {
        border-radius: 12px;
        border: 2px solid white;
        background-color: #e4aa17;
        color: white;
        font-weight: bold;
        font-size: 0.5em;
        min-width: 25px;
        text-align: center;
    }

    .play-queue-open {
        background-color: white;
        color: #333;
    }

</style>
<div id="player-section" class="fixed-footer player show-on-play">
    <div class="player-foreground no_selection" style="background: black; opacity: 0.9">
        <img id="player-badge-image" src="/images/default-profile.png" class="song-badge-image big-screen-only">
        <div class="song-badge-info">
            <div id=player-title-area  class="flex-row middle clickable title-link">
                <div id="player-title" class="player-song-name mr10">Song title which styupidly long that will cause some sort of snafu</div>
            </div>
            <div id="player-artist" class="player-artist-name clickable">Artist name which styupidly long that will cause some sort of snafu</div>
        </div>

        <i id="player-play-button" class="fa fa-play btn btn-plain player-control"
           onclick="audioPlayer.togglePlayState()"
           style="margin-right: 5px; color: #FFCD00"
           aria-hidden="true"></i>

        <img id="player-pause-button" onclick="audioPlayer.togglePlayState()" src="/images/player/pause.png"
             style="width: 55px; height: 55px; padding-right: 5px; margin-right: 4px"
             class="player-control">

        <div id=player-progress class="player-progress mr5 big-screen-only">
            <div class="progress-bar progress-background"></div>
            <div id="player-progress-div" class="progress-bar progress-foreground" style="background-color: darkorchid">
            </div>
            <div class="spread mt5">
                <div id="player-time-played" style="color: #FFCD00" class="player-time-field big-screen-only">00:00</div>
                <div id="player-time-left" style="color: #FFCD00" class="player-time-field">00:00</div>
            </div>
            <div id=progress-thumb class="progress-thumb draggable ui-widget-content"></div>
        </div>

        <i id="player-next-button" class="fa fa-lg fa-step-forward btn btn-plain player-control"
           onclick="audioPlayer.skipTrack()"
           style="color: #AE8C00"
           aria-hidden="true"></i>

        <div id="player-tip-button"
             title="Send a tip"
             class="clickable text-large mr10"
             context-type="Release"
             recipient="">
            <i class="fa fa-2x fa-heart btn btn-plain btn-sm"
               style="padding: 5px; color: #FFCD00"
               aria-hidden="true"></i>
        </div>
        <div class="clickable text-large mr10">
            <i id=shuffle class="fa fa-2x fa-random btn-plain btn-sm toggle-shuffle"
               style="padding: 5px; color: #FFCD00"
               aria-hidden="true"></i>
        </div>

        <div title="Show or hide the playlist"
                class="clickable text-large mr10"
                style="position: relative">
            <i id="play-queue-trigger"
               class="fa fa-list-ul btn-plain btn-sm play-queue-trigger"
               style="padding: 5px"
               aria-hidden="true"></i>
            <i id="play-queue-count"
               class="queue-size"
               aria-hidden="true"
               style="position: absolute;bottom: -9px;right: -13px;">0</i>
        </div>
    </div>
    <div id="player-background" class="player-background" style="background-image: url('')"></div>
</div>

<script>

  $(document).ready(function () {
    audioPlayer.initialize();

    audioPlayer.progressThumb.draggable({ axis: "x", containment: "#player-progress" });
    audioPlayer.progressThumb.draggable({
      start: function() {
        audioPlayer.seeking = true;
        audioPlayer.progressThumb.css('transition', 'none');
      },
      drag: function() {
      },
      stop: function() {
        audioPlayer.seeking = false;
        var position = parseInt(audioPlayer.progressThumb.css('left'));
        var max = audioPlayer.progressArea.width();
        var newValue = (position / max) * audioPlayer.audioElement.duration;
        if (!isNaN(newValue)) {
          audioPlayer.audioElement.currentTime = newValue;
          audioPlayer.syncProgressNow();
        }
      }
    });

    $("#player-tip-button").on('click', function() {
      var _tipModule = parent.document.getElementById("mainFrame").contentWindow.tipModule;
      _tipModule.accumulateTips($(this));
    })
  });
</script>
